<!--pages/favorite-content/favorite-content.wxml-->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading && favorites.length === 0}}" class="loading-container">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- æ”¶è—å†…å®¹åˆ—è¡¨ -->
  <view wx:elif="{{favorites.length > 0}}" class="favorites-container">
    <view class="favorite-item" 
          wx:for="{{favorites}}" 
          wx:key="_id"
          data-post-id="{{item.postId}}"
          data-favorite-id="{{item._id}}"
          data-post-title="{{item.postTitle}}"
          bindtap="onFavoriteTap"
          bindlongpress="onFavoriteLongPress">
      
      <!-- ä½œè€…ä¿¡æ¯ -->
      <view class="author-info">
        <image wx:if="{{item.postAuthorAvatar}}" 
               class="author-avatar" 
               src="{{item.postAuthorAvatar}}" 
               mode="aspectFill" />
        <view class="author-details">
          <view class="author-name">{{item.postAuthorName}}</view>
          <view class="post-time">{{item.formattedPostCreateTime}}</view>
        </view>
      </view>

      <!-- æ ‡é¢˜ -->
      <view wx:if="{{item.postTitle}}" class="post-title">{{item.postTitle}}</view>

      <!-- å†…å®¹ -->
      <view wx:if="{{item.postContent}}" class="post-content">{{item.postContent}}</view>

      <!-- å›¾ç‰‡ -->
      <view wx:if="{{item.postImageUrls && item.postImageUrls.length > 0}}" class="post-images">
        <view wx:if="{{item.postImageUrls.length === 1}}" class="single-image">
          <image class="post-image" 
                 src="{{item.postImageUrls[0]}}" 
                 mode="aspectFill"
                 data-src="{{item.postImageUrls[0]}}"
                 data-urls="{{item.postImageUrls}}"
                 bindtap="onImagePreview"
                 catchtap="onImagePreview" />
        </view>
        <view wx:else class="multi-images">
          <image class="post-image" 
                 wx:for="{{item.postImageUrls}}" 
                 wx:for-item="imageUrl"
                 wx:key="*this"
                 src="{{imageUrl}}" 
                 mode="aspectFill"
                 data-src="{{imageUrl}}"
                 data-urls="{{item.postImageUrls}}"
                 bindtap="onImagePreview"
                 catchtap="onImagePreview" />
        </view>
      </view>

      <!-- æ”¶è—æ—¶é—´ -->
      <view class="favorite-time">
        <text class="favorite-label">æ”¶è—äº</text>
        <text class="favorite-date">{{item.formattedCreateTime}}</text>
      </view>

      <!-- è¯—æ­Œæ ‡è¯† -->
      <view wx:if="{{item.postIsPoem}}" class="poem-badge">
        <text wx:if="{{item.postIsOriginal}}">åŸåˆ›è¯—æ­Œ</text>
        <text wx:else>ç»å…¸è¯—æ­Œ</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:else class="empty-container">
    <view class="empty-icon">ğŸ“–</view>
    <view class="empty-text">æ”¶è—å¤¹æ˜¯ç©ºçš„</view>
    <view class="empty-subtext">å»å‘ç°ä¸€äº›å¥½è¯—æ”¶è—èµ·æ¥å§</view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view wx:if="{{favorites.length > 0 && isLoading}}" class="loading-more">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- æ²¡æœ‰æ›´å¤š -->
  <view wx:if="{{favorites.length > 0 && !hasMore && !isLoading}}" class="no-more">
    <text>æ²¡æœ‰æ›´å¤šäº†</text>
  </view>
</view>
