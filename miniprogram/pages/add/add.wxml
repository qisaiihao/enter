<!-- pages/add/add.wxml -->
<view class="container">

<!-- 模式切换栏 -->
<view class="mode-switcher">
  <button class="mode-btn {{publishMode === 'normal' ? 'active' : ''}}" bindtap="switchMode">普通发布</button>
  <button class="mode-btn {{publishMode === 'poem' ? 'active' : ''}}" bindtap="switchMode">写诗</button>
</view>

<!-- 原创勾选(仅在诗歌模式显示) -->
<view wx:if="{{publishMode === 'poem'}}" class="original-checkbox" bindtap="toggleOriginal">
  <view class="checkbox-icon {{isOriginal ? 'checked' : ''}}">{{isOriginal ? '☑' : '☐'}}</view>
  <view class="checkbox-text">原创诗歌</view>
</view>

<!-- 1. 标题输入框 -->
<input 
  class="input-title" 
  placeholder="请在这里输入标题" 
  bindinput="onTitleInput"
/>

<!-- 2. 内容输入区域 -->
<textarea 
  class="textarea-content" 
  placeholder="请在这里尽情创作吧..." 
  bindinput="onContentInput"
></textarea>

<!-- 3. 图片上传与预览区域 -->
<view class="uploader-container">
  <view class="uploader-info">
    <text wx:if="{{publishMode === 'poem'}}" class="poem-image-tip">诗歌模式：上传1张图片作为读诗页背景</text>
    <text wx:else class="image-count">{{imageList.length}}/{{maxImageCount}}</text>
  </view>
  <view class="uploader-controls">
    <button wx:if="{{imageList.length === 0}}" class="uploader-button" bindtap="handleChooseImage">
      {{publishMode === 'poem' ? '上传背景图' : '上传图片'}}
    </button>
  </view>
  
  <!-- 显示多张图片预览 -->
  <view wx:if="{{imageList.length > 0}}" class="image-preview-container">
    <swiper wx:if="{{imageList.length > 1 && publishMode === 'normal'}}" class="image-swiper" indicator-dots="{{true}}" indicator-color="rgba(255, 255, 255, 0.6)" indicator-active-color="#ffffff" autoplay="{{false}}" circular="{{true}}">
      <swiper-item wx:for="{{imageList}}" wx:key="index" class="swiper-item">
        <image class="preview-image" src="{{item.previewUrl}}" mode="widthFix" binderror="onImageError"></image>
        <view class="image-remove-btn" bindtap="removeImage" data-index="{{index}}">×</view>
      </swiper-item>
    </swiper>
    <block wx:else>
      <view class="image-preview-item">
        <image class="preview-image" src="{{imageList[0].previewUrl}}" mode="widthFix" binderror="onImageError"></image>
        <view class="image-remove-btn" bindtap="removeImage" data-index="0">×</view>
      </view>
    </block>
    <view wx:if="{{imageList.length < maxImageCount && publishMode === 'normal'}}" class="add-more-btn" bindtap="handleChooseImage">
      <text>+</text>
    </view>
  </view>
</view>

<!-- 4. 页面底部的"确认发布"按钮 -->
<button 
  type="primary" 
  class="submit-button" 
  bindtap="submitPost"
>
  发布（可只上传图片）
</button>

</view> <!-- 这个 </view> 是用来闭合最外层的 <view class="container"> 的 -->